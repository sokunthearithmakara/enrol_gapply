!function(factory){if("function"==typeof define&&define.amd)define("enrol_gapply/dataTables.select",["jquery","enrol_gapply/jquery.dataTables"],(function($){return factory($,window,document)}));else if("object"==typeof exports){var jq=require("jquery"),cjsRequires=function(root,$){$.fn.dataTable||require("enrol_gapply/jquery.dataTables")(root,$)};"undefined"==typeof window?module.exports=function(root,$){return root||(root=window),$||($=jq(root)),cjsRequires(root,$),factory($,root,root.document)}:(cjsRequires(window,jq),module.exports=factory(jq,window,window.document))}else factory(jQuery,window,document)}((function($,window,document,undefined$1){var DataTable=$.fn.dataTable;function cellRange(dt,idx,last){var indexes,columnIndexes,rowIndexes,selectColumns=function(start,end){if(start>end){var tmp=end;end=start,start=tmp}var record=!1;return dt.columns(":visible").indexes().filter((function(i){return i===start&&(record=!0),i===end?(record=!1,!0):record}))},selectRows=function(start,end){var indexes=dt.rows({search:"applied"}).indexes();if(indexes.indexOf(start)>indexes.indexOf(end)){var tmp=end;end=start,start=tmp}var record=!1;return indexes.filter((function(i){return i===start&&(record=!0),i===end?(record=!1,!0):record}))};dt.cells({selected:!0}).any()||last?(columnIndexes=selectColumns(last.column,idx.column),rowIndexes=selectRows(last.row,idx.row)):(columnIndexes=selectColumns(0,idx.column),rowIndexes=selectRows(0,idx.row)),indexes=dt.cells(rowIndexes,columnIndexes).flatten(),dt.cells(idx,{selected:!0}).any()?dt.cells(indexes).deselect():dt.cells(indexes).select()}function disableMouseSelection(dt){var selector=dt.settings()[0]._select.selector;$(dt.table().container()).off("mousedown.dtSelect",selector).off("mouseup.dtSelect",selector).off("click.dtSelect",selector),$("body").off("click.dtSelect"+_safeId(dt.table().node()))}function enableMouseSelection(dt){var matchSelection,container=$(dt.table().container()),ctx=dt.settings()[0],selector=ctx._select.selector;container.on("mousedown.dtSelect",selector,(function(e){(e.shiftKey||e.metaKey||e.ctrlKey)&&container.css("-moz-user-select","none").one("selectstart.dtSelect",selector,(function(){return!1})),window.getSelection&&(matchSelection=window.getSelection())})).on("mouseup.dtSelect",selector,(function(){container.css("-moz-user-select","")})).on("click.dtSelect",selector,(function(e){var idx,items=dt.select.items();if(matchSelection){var selection=window.getSelection();if((!selection.anchorNode||$(selection.anchorNode).closest("table")[0]===dt.table().node())&&selection!==matchSelection)return}var ctx=dt.settings()[0],wrapperClass=dt.settings()[0].oClasses.sWrapper.trim().replace(/ +/g,".");if($(e.target).closest("div."+wrapperClass)[0]==dt.table().container()){var cell=dt.cell($(e.target).closest("td, th"));if(cell.any()){var event=$.Event("user-select.dt");if(eventTrigger(dt,event,[items,cell,e]),!event.isDefaultPrevented()){var cellIndex=cell.index();"row"===items?(idx=cellIndex.row,typeSelect(e,dt,ctx,"row",idx)):"column"===items?(idx=cell.index().column,typeSelect(e,dt,ctx,"column",idx)):"cell"===items&&(idx=cell.index(),typeSelect(e,dt,ctx,"cell",idx)),ctx._select_lastCell=cellIndex}}}})),$("body").on("click.dtSelect"+_safeId(dt.table().node()),(function(e){if(ctx._select.blurable){if($(e.target).parents().filter(dt.table().container()).length)return;if(0===$(e.target).parents("html").length)return;if($(e.target).parents("div.DTE").length)return;var event=$.Event("select-blur.dt");if(eventTrigger(dt,event,[e.target,e]),event.isDefaultPrevented())return;clear(ctx,!0)}}))}function eventTrigger(api,type,args,any){any&&!api.flatten().length||("string"==typeof type&&(type+=".dt"),args.unshift(api),$(api.table().node()).trigger(type,args))}function init(ctx){var api=new DataTable.Api(ctx);ctx._select_init=!0,ctx.aoRowCreatedCallback.push({fn:function(row,data,index){var i,ien,d=ctx.aoData[index];for(d._select_selected&&$(row).addClass(ctx._select.className),i=0,ien=ctx.aoColumns.length;i<ien;i++)(ctx.aoColumns[i]._select_selected||d._selected_cells&&d._selected_cells[i])&&$(d.anCells[i]).addClass(ctx._select.className)},sName:"select-deferRender"}),api.on("preXhr.dt.dtSelect",(function(e,settings){if(settings===api.settings()[0]){var rows=api.rows({selected:!0}).ids(!0).filter((function(d){return d!==undefined$1})),cells=api.cells({selected:!0}).eq(0).map((function(cellIdx){var id=api.row(cellIdx.row).id(!0);return id?{row:id,column:cellIdx.column}:undefined$1})).filter((function(d){return d!==undefined$1}));api.one("draw.dt.dtSelect",(function(){api.rows(rows).select(),cells.any()&&cells.each((function(id){api.cells(id.row,id.column).select()}))}))}})),api.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt info.dt",(function(){!function(api){var ctx=api.settings()[0];if(ctx._select.info&&ctx.aanFeatures.i&&"api"!==api.select.style()){var rows=api.rows({selected:!0}).flatten().length,columns=api.columns({selected:!0}).flatten().length,cells=api.cells({selected:!0}).flatten().length,add=function(el,name,num){el.append($('<span class="select-item"/>').append(api.i18n("select."+name+"s",{_:"%d "+name+"s selected",0:"",1:"1 "+name+" selected"},num)))};$.each(ctx.aanFeatures.i,(function(i,el){el=$(el);var output=$('<span class="select-info"/>');add(output,"row",rows),add(output,"column",columns),add(output,"cell",cells);var exisiting=el.children("span.select-info");exisiting.length&&exisiting.remove(),""!==output.text()&&el.append(output)}))}}(api),api.state.save()})),api.on("destroy.dtSelect",(function(){$(api.rows({selected:!0}).nodes()).removeClass(api.settings()[0]._select.className),disableMouseSelection(api),api.off(".dtSelect"),$("body").off(".dtSelect"+_safeId(api.table().node()))}))}function rowColumnRange(dt,type,idx,last){var indexes=dt[type+"s"]({search:"applied"}).indexes(),idx1=$.inArray(last,indexes),idx2=$.inArray(idx,indexes);if(dt[type+"s"]({selected:!0}).any()||-1!==idx1){if(idx1>idx2){var tmp=idx2;idx2=idx1,idx1=tmp}indexes.splice(idx2+1,indexes.length),indexes.splice(0,idx1)}else indexes.splice($.inArray(idx,indexes)+1,indexes.length);dt[type](idx,{selected:!0}).any()?(indexes.splice($.inArray(idx,indexes),1),dt[type+"s"](indexes).deselect()):dt[type+"s"](indexes).select()}function clear(ctx,force){if(force||"single"===ctx._select.style){var api=new DataTable.Api(ctx);api.rows({selected:!0}).deselect(),api.columns({selected:!0}).deselect(),api.cells({selected:!0}).deselect()}}function typeSelect(e,dt,ctx,type,idx){var style=dt.select.style(),toggleable=dt.select.toggleable(),isSelected=dt[type](idx,{selected:!0}).any();if(!isSelected||toggleable)if("os"===style)if(e.ctrlKey||e.metaKey)dt[type](idx).select(!isSelected);else if(e.shiftKey)"cell"===type?cellRange(dt,idx,ctx._select_lastCell||null):rowColumnRange(dt,type,idx,ctx._select_lastCell?ctx._select_lastCell[type]:null);else{var selected=dt[type+"s"]({selected:!0});isSelected&&1===selected.flatten().length?dt[type](idx).deselect():(selected.deselect(),dt[type](idx).select())}else"multi+shift"==style&&e.shiftKey?"cell"===type?cellRange(dt,idx,ctx._select_lastCell||null):rowColumnRange(dt,type,idx,ctx._select_lastCell?ctx._select_lastCell[type]:null):dt[type](idx).select(!isSelected)}function _safeId(node){return node.id.replace(/[^a-zA-Z0-9\-\_]/g,"-")}DataTable.select={},DataTable.select.version="1.7.0",DataTable.select.init=function(dt){var ctx=dt.settings()[0];if(!ctx._select){var savedSelected=dt.state.loaded(),selectAndSave=function(e,settings,data){if(null!==data&&data.select!==undefined$1){if(dt.rows({selected:!0}).any()&&dt.rows().deselect(),data.select.rows!==undefined$1&&dt.rows(data.select.rows).select(),dt.columns({selected:!0}).any()&&dt.columns().deselect(),data.select.columns!==undefined$1&&dt.columns(data.select.columns).select(),dt.cells({selected:!0}).any()&&dt.cells().deselect(),data.select.cells!==undefined$1)for(var i=0;i<data.select.cells.length;i++)dt.cell(data.select.cells[i].row,data.select.cells[i].column).select();dt.state.save()}};dt.on("stateSaveParams",(function(e,settings,data){data.select={},data.select.rows=dt.rows({selected:!0}).ids(!0).toArray(),data.select.columns=dt.columns({selected:!0})[0],data.select.cells=dt.cells({selected:!0})[0].map((function(coords){return{row:dt.row(coords.row).id(!0),column:coords.column}}))})).on("stateLoadParams",selectAndSave).one("init",(function(){selectAndSave(0,0,savedSelected)}));var init=ctx.oInit.select,defaults=DataTable.defaults.select,opts=init===undefined$1?defaults:init,items="row",style="api",blurable=!1,toggleable=!0,info=!0,selector="td, th",className="selected",setStyle=!1;ctx._select={},!0===opts?(style="os",setStyle=!0):"string"==typeof opts?(style=opts,setStyle=!0):$.isPlainObject(opts)&&(opts.blurable!==undefined$1&&(blurable=opts.blurable),opts.toggleable!==undefined$1&&(toggleable=opts.toggleable),opts.info!==undefined$1&&(info=opts.info),opts.items!==undefined$1&&(items=opts.items),opts.style!==undefined$1?(style=opts.style,setStyle=!0):(style="os",setStyle=!0),opts.selector!==undefined$1&&(selector=opts.selector),opts.className!==undefined$1&&(className=opts.className)),dt.select.selector(selector),dt.select.items(items),dt.select.style(style),dt.select.blurable(blurable),dt.select.toggleable(toggleable),dt.select.info(info),ctx._select.className=className,$.fn.dataTable.ext.order["select-checkbox"]=function(settings,col){return this.api().column(col,{order:"index"}).nodes().map((function(td){return"row"===settings._select.items?$(td).parent().hasClass(settings._select.className):"cell"===settings._select.items&&$(td).hasClass(settings._select.className)}))},!setStyle&&$(dt.table().node()).hasClass("selectable")&&dt.select.style("os")}},$.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],(function(i,o){DataTable.ext.selector[o.type].push((function(settings,opts,indexes){var data,selected=opts.selected,out=[];if(!0!==selected&&!1!==selected)return indexes;for(var i=0,ien=indexes.length;i<ien;i++)data=settings[o.prop][indexes[i]],(!0===selected&&!0===data._select_selected||!1===selected&&!data._select_selected)&&out.push(indexes[i]);return out}))})),DataTable.ext.selector.cell.push((function(settings,opts,cells){var rowData,selected=opts.selected,out=[];if(selected===undefined$1)return cells;for(var i=0,ien=cells.length;i<ien;i++)rowData=settings.aoData[cells[i].row],(!0===selected&&rowData._selected_cells&&!0===rowData._selected_cells[cells[i].column]||!1===selected&&(!rowData._selected_cells||!rowData._selected_cells[cells[i].column]))&&out.push(cells[i]);return out}));var apiRegister=DataTable.Api.register,apiRegisterPlural=DataTable.Api.registerPlural;function i18n(label,def){return function(dt){return dt.i18n("buttons."+label,def)}}function namespacedEvents(config){var unique=config._eventNamespace;return"draw.dt.DT"+unique+" select.dt.DT"+unique+" deselect.dt.DT"+unique}apiRegister("select()",(function(){return this.iterator("table",(function(ctx){DataTable.select.init(new DataTable.Api(ctx))}))})),apiRegister("select.blurable()",(function(flag){return flag===undefined$1?this.context[0]._select.blurable:this.iterator("table",(function(ctx){ctx._select.blurable=flag}))})),apiRegister("select.toggleable()",(function(flag){return flag===undefined$1?this.context[0]._select.toggleable:this.iterator("table",(function(ctx){ctx._select.toggleable=flag}))})),apiRegister("select.info()",(function(flag){return flag===undefined$1?this.context[0]._select.info:this.iterator("table",(function(ctx){ctx._select.info=flag}))})),apiRegister("select.items()",(function(items){return items===undefined$1?this.context[0]._select.items:this.iterator("table",(function(ctx){ctx._select.items=items,eventTrigger(new DataTable.Api(ctx),"selectItems",[items])}))})),apiRegister("select.style()",(function(style){return style===undefined$1?this.context[0]._select.style:this.iterator("table",(function(ctx){ctx._select||DataTable.select.init(new DataTable.Api(ctx)),ctx._select_init||init(ctx),ctx._select.style=style;var dt=new DataTable.Api(ctx);disableMouseSelection(dt),"api"!==style&&enableMouseSelection(dt),eventTrigger(new DataTable.Api(ctx),"selectStyle",[style])}))})),apiRegister("select.selector()",(function(selector){return selector===undefined$1?this.context[0]._select.selector:this.iterator("table",(function(ctx){disableMouseSelection(new DataTable.Api(ctx)),ctx._select.selector=selector,"api"!==ctx._select.style&&enableMouseSelection(new DataTable.Api(ctx))}))})),apiRegisterPlural("rows().select()","row().select()",(function(select){var api=this;return!1===select?this.deselect():(this.iterator("row",(function(ctx,idx){clear(ctx),ctx.aoData[idx]._select_selected=!0,$(ctx.aoData[idx].nTr).addClass(ctx._select.className)})),this.iterator("table",(function(ctx,i){eventTrigger(api,"select",["row",api[i]],!0)})),this)})),apiRegister("row().selected()",(function(){var ctx=this.context[0];return!!(ctx&&this.length&&ctx.aoData[this[0]]&&ctx.aoData[this[0]]._select_selected)})),apiRegisterPlural("columns().select()","column().select()",(function(select){var api=this;return!1===select?this.deselect():(this.iterator("column",(function(ctx,idx){clear(ctx),ctx.aoColumns[idx]._select_selected=!0;var column=new DataTable.Api(ctx).column(idx);$(column.header()).addClass(ctx._select.className),$(column.footer()).addClass(ctx._select.className),column.nodes().to$().addClass(ctx._select.className)})),this.iterator("table",(function(ctx,i){eventTrigger(api,"select",["column",api[i]],!0)})),this)})),apiRegister("column().selected()",(function(){var ctx=this.context[0];return!!(ctx&&this.length&&ctx.aoColumns[this[0]]&&ctx.aoColumns[this[0]]._select_selected)})),apiRegisterPlural("cells().select()","cell().select()",(function(select){var api=this;return!1===select?this.deselect():(this.iterator("cell",(function(ctx,rowIdx,colIdx){clear(ctx);var data=ctx.aoData[rowIdx];data._selected_cells===undefined$1&&(data._selected_cells=[]),data._selected_cells[colIdx]=!0,data.anCells&&$(data.anCells[colIdx]).addClass(ctx._select.className)})),this.iterator("table",(function(ctx,i){eventTrigger(api,"select",["cell",api.cells(api[i]).indexes().toArray()],!0)})),this)})),apiRegister("cell().selected()",(function(){var ctx=this.context[0];if(ctx&&this.length){var row=ctx.aoData[this[0][0].row];if(row&&row._selected_cells&&row._selected_cells[this[0][0].column])return!0}return!1})),apiRegisterPlural("rows().deselect()","row().deselect()",(function(){var api=this;return this.iterator("row",(function(ctx,idx){ctx.aoData[idx]._select_selected=!1,ctx._select_lastCell=null,$(ctx.aoData[idx].nTr).removeClass(ctx._select.className)})),this.iterator("table",(function(ctx,i){eventTrigger(api,"deselect",["row",api[i]],!0)})),this})),apiRegisterPlural("columns().deselect()","column().deselect()",(function(){var api=this;return this.iterator("column",(function(ctx,idx){ctx.aoColumns[idx]._select_selected=!1;var api=new DataTable.Api(ctx),column=api.column(idx);$(column.header()).removeClass(ctx._select.className),$(column.footer()).removeClass(ctx._select.className),api.cells(null,idx).indexes().each((function(cellIdx){var data=ctx.aoData[cellIdx.row],cellSelected=data._selected_cells;!data.anCells||cellSelected&&cellSelected[cellIdx.column]||$(data.anCells[cellIdx.column]).removeClass(ctx._select.className)}))})),this.iterator("table",(function(ctx,i){eventTrigger(api,"deselect",["column",api[i]],!0)})),this})),apiRegisterPlural("cells().deselect()","cell().deselect()",(function(){var api=this;return this.iterator("cell",(function(ctx,rowIdx,colIdx){var data=ctx.aoData[rowIdx];data._selected_cells!==undefined$1&&(data._selected_cells[colIdx]=!1),data.anCells&&!ctx.aoColumns[colIdx]._select_selected&&$(data.anCells[colIdx]).removeClass(ctx._select.className)})),this.iterator("table",(function(ctx,i){eventTrigger(api,"deselect",["cell",api[i]],!0)})),this}));var _buttonNamespace=0;return $.extend(DataTable.ext.buttons,{selected:{text:i18n("selected","Selected"),className:"buttons-selected",limitTo:["rows","columns","cells"],init:function(dt,node,config){var that=this;config._eventNamespace=".select"+_buttonNamespace++,dt.on(namespacedEvents(config),(function(){that.enable(function(dt,config){return!(-1===$.inArray("rows",config.limitTo)||!dt.rows({selected:!0}).any())||!(-1===$.inArray("columns",config.limitTo)||!dt.columns({selected:!0}).any())||!(-1===$.inArray("cells",config.limitTo)||!dt.cells({selected:!0}).any())}(dt,config))})),this.disable()},destroy:function(dt,node,config){dt.off(config._eventNamespace)}},selectedSingle:{text:i18n("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(dt,node,config){var that=this;config._eventNamespace=".select"+_buttonNamespace++,dt.on(namespacedEvents(config),(function(){var count=dt.rows({selected:!0}).flatten().length+dt.columns({selected:!0}).flatten().length+dt.cells({selected:!0}).flatten().length;that.enable(1===count)})),this.disable()},destroy:function(dt,node,config){dt.off(config._eventNamespace)}},selectAll:{text:i18n("selectAll","Select all"),className:"buttons-select-all",action:function(e,dt,node,config){var items=this.select.items(),mod=config.selectorModifier;mod?("function"==typeof mod&&(mod=mod.call(dt,e,dt,node,config)),this[items+"s"](mod).select()):this[items+"s"]().select()}},selectNone:{text:i18n("selectNone","Deselect all"),className:"buttons-select-none",action:function(){clear(this.settings()[0],!0)},init:function(dt,node,config){var that=this;config._eventNamespace=".select"+_buttonNamespace++,dt.on(namespacedEvents(config),(function(){var count=dt.rows({selected:!0}).flatten().length+dt.columns({selected:!0}).flatten().length+dt.cells({selected:!0}).flatten().length;that.enable(count>0)})),this.disable()},destroy:function(dt,node,config){dt.off(config._eventNamespace)}},showSelected:{text:i18n("showSelected","Show only selected"),className:"buttons-show-selected",action:function(e,dt,node,conf){if(conf._filter){var idx=DataTable.ext.search.indexOf(conf._filter);-1!==idx&&(DataTable.ext.search.splice(idx,1),conf._filter=null),this.active(!1)}else{var fn=function(s,data,idx){if(s!==dt.settings()[0])return!0;return s.aoData[idx]._select_selected};conf._filter=fn,DataTable.ext.search.push(fn),this.active(!0)}dt.draw()}}}),$.each(["Row","Column","Cell"],(function(i,item){var lc=item.toLowerCase();DataTable.ext.buttons["select"+item+"s"]={text:i18n("select"+item+"s","Select "+lc+"s"),className:"buttons-select-"+lc+"s",action:function(){this.select.items(lc)},init:function(dt){var that=this;dt.on("selectItems.dt.DT",(function(e,ctx,items){that.active(items===lc)}))}}})),$.fn.DataTable.select=DataTable.select,$(document).on("preInit.dt.dtSelect",(function(e,ctx){"dt"===e.namespace&&DataTable.select.init(new DataTable.Api(ctx))})),DataTable}));

//# sourceMappingURL=dataTables.select.min.js.map