define("enrol_gapply/previewfile",["exports","jquery","core/notification","core/toast"],(function(_exports,_jquery,_notification,_toast){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_notification=_interopRequireDefault(_notification);_exports.init=()=>{(0,_jquery.default)(document).on("click","a[data-type]",(function(){var modal='<div class="modal fade" id="applyfile" data-backdrop="static"\n         data-keyboard="false" tabindex="-1" aria-labelledby="applyfileLabel" aria-modal="true" role="dialog">\n                        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">\n                            <div class="modal-content">\n                                <div class="modal-header">\n                                    <h5 class="modal-title flex-grow-1" id="applyfileLabel"></h5>\n                                    <button class="close" data-dismiss="modal" data-bs-dismiss="modal" aria-label="Close">\n                                    <i class="fa fa-times" aria-hidden="true"></i>\n                                    </button>\n                                </div>\n                                <div class="modal-body p-0 text-center d-flex justify-content-center">\n                                </div>\n                                <div class="modal-footer">\n                                    <a href="javascript:void(0)" id="forcedownloadbutton"\n                                        class="btn btn-primary text-uppercase font-weight-bold">\n                                        '.concat(M.util.get_string("download","enrol_gapply"),'</a>\n                                    <button class="btn btn-secondary text-uppercase font-weight-bold"\n                                        data-dismiss="modal" data-bs-dismiss="modal">\n                                        ').concat(M.util.get_string("close","enrol_gapply"),"</button>\n                                </div>\n                            </div>\n                        </div>\n                </div>");(0,_jquery.default)("#applyfile").remove(),(0,_jquery.default)("body").append(modal),(0,_jquery.default)("#applyfileLabel").html((0,_jquery.default)(this).text()),(0,_jquery.default)("#applyfile").modal("show");let html="";(0,_jquery.default)(this).data("type").includes("image")?((0,_jquery.default)("#applyfile .modal-body").removeClass("d-flex"),html='<img src="'.concat((0,_jquery.default)(this).data("url"),'" class="img-fluid mx-auto">')):(0,_jquery.default)(this).data("type").includes("video")?html='<video src="'.concat((0,_jquery.default)(this).data("url"),'"\n                    class="embed-responsive-item text-center m-0" controls width="100%" autoplay></video>'):(0,_jquery.default)(this).data("type").includes("audio")?((0,_jquery.default)("#applyfile .modal-body").removeClass("d-flex"),html='<audio src="'.concat((0,_jquery.default)(this).data("url"),'"\n                    class="embed-responsive-item text-center m-0" controls width="100%" autoplay></audio>')):(0,_jquery.default)(this).data("type").includes("pdf")?html='<object data="'.concat((0,_jquery.default)(this).data("url"),'" type="application/pdf"\n                     width="100%" style="height: 80vh">\n                                            <p>').concat(M.util.get_string("cannotopenpdffile","enrol_gapply",(0,_jquery.default)(this).data("url")),"</p>\n                                            </object>"):(0,_jquery.default)(this).data("type").includes("officedocument")||(0,_jquery.default)(this).data("type").includes("msword")||(0,_jquery.default)(this).data("type").includes("ms-excel")||(0,_jquery.default)(this).data("type").includes("ms-powerpoint")||(0,_jquery.default)(this).data("type").includes("openxmlformats")?html='<iframe id="fileviewer"\n                    src="https://view.officeapps.live.com/op/embed.aspx?src='.concat((0,_jquery.default)(this).data("url"),'"\n                    class="embed-responsive-item" style="width: 100%; height: 80vh"></iframe>'):(0,_jquery.default)(this).data("type").includes("text")||(0,_jquery.default)(this).data("type").includes("csv")?html='<iframe id="fileviewer"\n                    src="https://docs.google.com/viewer?url='.concat((0,_jquery.default)(this).data("url"),'&embedded=true"\n                    class="embed-responsive-item" style="width: 100%; height: 80vh; border-radius: 0"></iframe>'):((0,_jquery.default)("#applyfile .modal-body").removeClass("d-flex"),html='<p class="text-center py-5">'.concat(M.util.get_string("cannotopenfile","enrol_gapply",(0,_jquery.default)(this).data("url")),"</p>")),(0,_jquery.default)("#applyfile .modal-body").html(html);var newURL=new URL((0,_jquery.default)(this).data("url"));(0,_jquery.default)("#applyfile").on("click","#forcedownloadbutton",(function(){newURL.searchParams.append("forcedownload",1),window.open(newURL.toString())}))})),(0,_jquery.default)(document).on("click","#withdraw",(function(e){e.preventDefault();const withdraw=()=>{_jquery.default.ajax({method:"POST",url:M.cfg.wwwroot+"/enrol/gapply/ajax.php",data:{action:"withdraw",id:(0,_jquery.default)(".btn#withdraw").data("instance"),sesskey:M.cfg.sesskey},dataType:"text",success:()=>{(0,_toast.add)(M.util.get_string("applicationwithdrawnsuccess","enrol_gapply"),{type:"success"}),setTimeout((()=>{location.reload()}),1e3)},error:()=>{(0,_toast.add)(M.util.get_string("anerroroccurred","enrol_gapply"),{type:"danger"})}})};try{_notification.default.deleteCancelPromise(M.util.get_string("withdrawapplication","enrol_gapply"),M.util.get_string("withdrawapplicationconfirm","enrol_gapply"),M.util.get_string("withdraw","enrol_gapply")).then((()=>withdraw())).catch((()=>{}))}catch{_notification.default.saveCancel(M.util.get_string("withdrawapplication","enrol_gapply"),M.util.get_string("withdrawapplicationconfirm","enrol_gapply"),M.util.get_string("withdraw","enrol_gapply"),(function(){return withdraw()}))}}))}}));

//# sourceMappingURL=previewfile.min.js.map