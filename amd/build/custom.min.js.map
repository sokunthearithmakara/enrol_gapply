{"version":3,"file":"custom.min.js","sources":["../src/custom.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\n/* eslint-disable no-empty-function */\n/* eslint-disable no-undef */\n/* eslint-disable max-len */\n/**\n * Available modules not used: enrol_gapply/select2\n */\ndefine(\n    [\n        'jquery',\n        'enrol_gapply/jszip',\n        'core/toast',\n        'enrol_gapply/jquery.dataTables',\n        'enrol_gapply/dataTables.bootstrap4',\n        'enrol_gapply/dataTables.select',\n        'enrol_gapply/select.bootstrap4',\n        'enrol_gapply/dataTables.buttons',\n        'enrol_gapply/buttons.bootstrap4',\n        'enrol_gapply/buttons.html5',\n        'enrol_gapply/dataTables.rowGroup',\n        'enrol_gapply/rowGroup.bootstrap4',\n        'enrol_gapply/buttons.colVis',\n    ], function ($, JSZip, toast) {\n        window.JSZip = JSZip;\n        return {\n            init: function (tab, id) {\n\n                $(\"body\").on('click', 'a[data-type]', function (e) {\n                    var modal = `<div class=\"modal fade\" id=\"applyfile\" data-backdrop=\"static\" data-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"applyfileLabel\" aria-modal=\"true\" role=\"dialog\">\n                                                    <div class=\"modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable\">\n                                                        <div class=\"modal-content\">\n                                                            <div class=\"modal-header\">\n                                                                <h5 class=\"modal-title\" id=\"applyfileLabel\"></h5>\n                                                                <button class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                                                <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\n                                                                </button>\n                                                            </div>\n                                                            <div class=\"modal-body p-0 text-center d-flex justify-content-center\">\n                                                            </div>\n                                                            <div class=\"modal-footer\">\n                                                                <a href=\"javascript:void(0)\" id=\"forcedownloadbutton\"\n                                                                    class=\"btn btn-primary text-uppercase font-weight-bold\">${M.util.get_string(\"download\", \"enrol_gapply\")}</a>\n                                                                <button class=\"btn btn-secondary text-uppercase font-weight-bold\"\n                                                                    data-dismiss=\"modal\">${M.util.get_string(\"close\", \"enrol_gapply\")}</button>\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                            </div>`;\n                    // Remove existing modal\n                    $(\"#applyfile\").remove();\n                    $(\"body\").append(modal);\n                    $(\"#applyfileLabel\").html($(this).text());\n                    $(\"#applyfile\").modal(\"show\");\n                    if ($(this).data(\"type\").includes(\"image\")) {\n                        $(\"#applyfile .modal-body\").html(`<img src=\"${$(this).data(\"url\")}\" class=\"img-fluid mx-auto\">`).removeClass(\"d-flex\");\n                    } else if ($(this).data(\"type\").includes(\"video\")) {\n                        $(\"#applyfile .modal-body\").html(`<video src=\"${$(this).data(\"url\")}\"\n                    class=\"embed-responsive-item text-center m-0\" controls width=\"100%\" autoplay></video>`);\n                    } else if ($(this).data(\"type\").includes(\"audio\")) {\n                        $(\"#applyfile .modal-body\").html(`<audio src=\"${$(this).data(\"url\")}\"\n                    class=\"embed-responsive-item text-center m-0\" controls width=\"100%\" autoplay></audio>`);\n                    } else if ($(this).data(\"type\").includes(\"pdf\")) {\n                        $(\"#applyfile .modal-body\").html(`<object data=\"${$(this).data(\"url\")}\" type=\"application/pdf\"\n                     width=\"100%\" style=\"height: 80vh\">\n                                            <p>${M.util.get_string('cannotopenpdffile', 'enrol_gapply', $(this).data(\"url\"))}</p>\n                                            </object>`);\n                    } else if ($(this).data(\"type\").includes(\"officedocument\") || $(this).data(\"type\").includes(\"msword\")\n                        || $(this).data(\"type\").includes(\"ms-excel\") || $(this).data(\"type\").includes(\"ms-powerpoint\") || $(this).data(\"type\").includes(\"openxmlformats\")) {\n                        $(\"#applyfile .modal-body\").html(`<iframe id=\"fileviewer\"\n                    src=\"https://view.officeapps.live.com/op/embed.aspx?src=${$(this).data(\"url\")}\"\n                    class=\"embed-responsive-item\" style=\"width: 100%; height: 80vh\"></iframe>`);\n                    } else if ($(this).data(\"type\").includes(\"text\") || $(this).data(\"type\").includes(\"csv\")) {\n                        $(\"#applyfile .modal-body\").html(`<iframe id=\"fileviewer\"\n                    src=\"https://docs.google.com/viewer?url=${$(this).data(\"url\")}&embedded=true\"\n                    class=\"embed-responsive-item\" style=\"width: 100%; height: 80vh; border-radius: 0\"></iframe>`);\n                    } else {\n                        $(\"#applyfile .modal-body\").html(`<p\n                    class=\"text-center py-5\">${M.util.get_string('cannotopenfile', 'enrol_gapply', $(this).data(\"url\"))}</p>`).removeClass(\"d-flex\");\n                    }\n\n                    var newURL = new URL($(this).data(\"url\"));\n\n                    $(\"#applyfile\").on(\"click\", \"#forcedownloadbutton\", function (e) {\n                        newURL.searchParams.append(\"forcedownload\", 1);\n                        window.open(newURL.toString());\n                    });\n                });\n\n                var timecreatedIndex = $(\"th\").index($(\"th.timecreated\"));\n                var profileFields = [];\n                $(\"th.profilefield\").each(function (index, element) {\n                    var pr = {\n                        index: $(\"th\").index($(this)),\n                        text: $(this).text(),\n                    };\n                    profileFields.push(pr);\n                });\n\n                const renderFilterBox = (index, text) => {\n                    return `<div class=\"col-sm-6 col-md-4 col-lg-3 col-xl-2 pl-0 pr-2\">\n                                    <div class=\"form-group mb-1\">\n                                        <label for=\"filter-${index}\">${text}</label>\n                                        <input type=\"text\" class=\"form-control form-control-sm\" id=\"filter-${index}\" data-index=\"${index}\"/>\n                                    </div>\n                                </div>`;\n                };\n\n                var option = {\n                    ajax: {\n                        url: M.cfg.wwwroot + '/enrol/gapply/ajax.php' + `?id=${id}&action=getapplications&tab=${tab}&sesskey=${M.cfg.sesskey}`,\n                        dataSrc: function (json) {\n                            return json;\n                        },\n                    },\n                    deferRender: true,\n                    rowId: 'id',\n                    dom: `<'d-flex align-items-start justify-content-between'<'d-flex align-items-start'Bl>f><'#filterregion.w-100 row'>t<'row'<'col-sm-6'i><'col-sm-6'p>>`,\n                    buttons: [\n                        // Copy button\n                        {\n                            extend: \"copyHtml5\",\n                            text: '<i class=\"fa fa-copy fa-fw\"></i>',\n                            titleAttr: \"\",\n                            className: \"btn btn-sm btn-alt-primary\",\n                            messageTop: null,\n                            title: null,\n                            exportOptions: {\n                                columns: ['.exportable']\n                            }\n                        },\n                        // Csv button\n                        {\n                            extend: \"csvHtml5\",\n                            text: '<i class=\"fa fa-file-csv fa-fw\"></i>',\n                            titleAttr: \"\",\n                            className: \"btn btn-sm btn-alt-primary\",\n                            exportOptions: {\n                                columns: ['.exportable']\n                            }\n                        },\n                        // Excel button\n                        {\n                            extend: \"excelHtml5\",\n                            text: '<i class=\"fa fa-file-excel fa-fw\"></i>',\n                            titleAttr: \"\",\n                            className: \"btn btn-sm btn-alt-primary\",\n                            exportOptions: {\n                                columns: ['.exportable']\n                            }\n                        },\n                        {\n                            extend: \"colvis\",\n                            text: '<i class=\"fa fa-columns fa-fw\"></i>',\n                            titleAttr: \"\",\n                            className: \"btn btn-sm btn-alt-primary\",\n                            columns: '.colvis'\n                        },\n                    ],\n                    \"language\": {\n                        \"lengthMenu\": \"_MENU_\",\n                        \"zeroRecords\": M.util.get_string('nofound', \"enrol_gapply\"),\n                        \"search\": M.util.get_string('search', \"enrol_gapply\"),\n                        \"info\": M.util.get_string('datatableinfo', \"enrol_gapply\"),\n                        \"infoEmpty\": M.util.get_string('datatableinfoempty', \"enrol_gapply\"),\n                        \"infoFiltered\": M.util.get_string('datatableinfofiltered', \"enrol_gapply\"),\n                        \"paginate\": {\n                            \"first\": M.util.get_string('first', 'enrol_gapply'),\n                            \"last\": M.util.get_string('last', 'enrol_gapply'),\n                            \"next\": M.util.get_string('next', 'enrol_gapply'),\n                            \"previous\": M.util.get_string('previous', 'enrol_gapply')\n                        },\n                        select: {\n                            rows: {\n                                _: M.util.get_string('rowsselected', 'enrol_gapply'),\n                            }\n                        }\n                    },\n                    \"order\": [[timecreatedIndex, \"desc\"]],\n                    \"columnDefs\": [{\n                        orderable: false,\n                        className: 'select-checkbox',\n                        targets: 0,\n                        visible: $(\"#gapplytable\").hasClass(\"approved\") ? false : true\n                    },\n                    {\n                        targets: 'userdetails',\n                        className: 'text-truncate',\n                    },\n                    {\n                        \"targets\": 'inv',\n                        \"visible\": false,\n                    },\n                    {\n                        'targets': 'noorder',\n                        'orderable': false,\n                    }\n                    ],\n                    'initComplete': function () {\n                        // Wrap the table in a div with overflow-x:auto\n                        $('#gapplytable').wrap('<div style=\"overflow-x:auto;\"></div>');\n                        $('.dataTables_length').addClass('mx-1');\n                        $('#gapplytable').addClass('mx-n1');\n                        $('.table-responsive').css('overflow', 'visible');\n                        // Remove d-none class\n                        $('#gapplytable').removeClass('d-none');\n                        $(\".dataTables_filter\").addClass(\"d-flex align-items-start float-right\");\n                        $(`<a class=\"btn btn-sm btn-secondary font-weight-bold ml-1\" href=\"javascript:void(0)\" id=\"filters\" data-toggle=\"tooltip\" title=\"Filter\" onclick=\"$('#filterregion').slideToggle('fast', 'swing')\"><i class=\"fa fa-filter left fa-fw\"></i></a>`).insertAfter(\".dataTables_filter label\");\n                        $('#filterregion').css('display', 'none');\n                        profileFields.forEach((element) => {\n                            $(renderFilterBox(element.index, element.text)).appendTo(\"#filterregion\");\n                        });\n                        // Create sort dropdown\n                        $(`<div class=\"dropdown d-inline right small\">\n                    <button class=\"btn btn-sm btn-secondary dropdown-toggle font-weight-bold ml-1\" id=\"dropdownMenuButton\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"><i class=\"fa fa-sort fa-fw\"></i>\n                    </button>\n                    <div class=\"dropdown-menu dropdown-menu-right\" id=\"sortdropdown\" aria-labelledby=\"dropdownMenuButton\">\n\n                    </div>\n                </div>`).insertAfter(\"#filters\");\n                        profileFields.forEach((element) => {\n                            $('#sortdropdown').append(`<a class=\"dropdown-item\" href=\"javascript:void(0)\" data-col=\"${element.index}\">${element.text}</a>`);\n                        });\n                        $('#sortdropdown').append(`<a class=\"dropdown-item\" href=\"javascript:void(0)\" data-col=\"${timecreatedIndex}\">${M.util.get_string('timecreated', 'enrol_gapply')}</a><div class=\"dropdown-divider\"></div>\n                        <a class=\"dropdown-item active\" href=\"javascript:void(0)\" data-order=\"desc\">${M.util.get_string('desc', \"enrol_gapply\")}</a>\n                        <a class=\"dropdown-item\" href=\"javascript:void(0)\" data-order=\"asc\">${M.util.get_string('asc', \"enrol_gapply\")}</a>`);\n                    },\n                };\n\n                if (!$(\"#gapplytable\").hasClass(\"approved\")) {\n                    option.select = {\n                        style: 'os',\n                        selector: 'td:first-child'\n                    };\n                }\n\n                var table = $('#gapplytable').DataTable(option);\n\n                // Handle filter event\n                $('body').on('keyup', '#filterregion input', function () {\n                    var index = $(this).data('index');\n                    var value = $(this).val();\n                    table.column(index).search(value, false, true).draw();\n                });\n\n                // Handle sort event\n                $(\"body\").on(\"click\", \"#sortdropdown.dropdown-menu a\", function () {\n                    // If sort order is selected\n                    if ($(this).data(\"order\")) {\n                        // Remove active class from all sort order options\n                        $(\".dropdown-menu a[data-order]\").removeClass(\"active\");\n                        // Add active class to the selected sort order option\n                        $(this).addClass(\"active\");\n                        // Set the sort order to the selected sort order\n                    } else {\n                        // If sort column is selected\n                        // remove active class from all sort column options\n                        $(\".dropdown-menu a[data-col]\").removeClass(\"active\");\n                        // Add active class to the selected sort column option\n                        $(this).addClass(\"active\");\n                        // Set the sort column to the selected sort column\n                    }\n                    // Get the sort column\n                    var colIndex = $(\".dropdown-menu a[data-col].active\").data(\"col\");\n                    // Get the sort order\n                    var order = $(\".dropdown-menu a[data-order].active\").data(\"order\");\n                    // Sort the table\n                    table.order([colIndex, order]).draw();\n                });\n\n                var selecteddata;\n\n                let getRowData = (table, rows) => {\n                    $(\".action-button:not(.menu-action)\").remove();\n                    selecteddata = table.rows({ selected: true }).data().toArray().map(row => row[1]);\n                    if (selecteddata.length > 0) {\n                        $(\"#gapplytable_length label\").after(`\n                            <button class=\"btn btn-sm alert-success action-button\" data-action=\"approve\" data-toggle=\"tooltip\" title=\"${M.util.get_string(\"approve\", \"enrol_gapply\")}\"><i class=\"fa fa-fw fa-check\"></i></button>\n                            <button class=\"btn btn-sm alert-info action-button\" data-action=\"waitlist\" data-toggle=\"tooltip\" title=\"${M.util.get_string(\"waitlist\", \"enrol_gapply\")}\"><i class=\"fa fa-fw fa-stopwatch\"></i></button>\n                            <button class=\"btn btn-sm alert-warning action-button\" data-action=\"reject\" data-toggle=\"tooltip\" title=\"${M.util.get_string(\"reject\", \"enrol_gapply\")}\"><i class=\"fa fa-fw fa-times\"></i></button>\n                            <button class=\"btn btn-sm alert-danger action-button\" data-action=\"delete\" data-toggle=\"tooltip\" title=\"${M.util.get_string(\"delete\", \"enrol_gapply\")}\"><i class=\"fa fa-fw fa-trash\"></i></button>`\n                        );\n                    } else {\n                        $(\".action-button:not(.menu-action)\").remove();\n                    }\n                };\n\n                table.on('select', function (e, dt, type, indexes) {\n                    getRowData(dt, indexes);\n                });\n                table.on('deselect', function (e, dt, type, indexes) {\n                    getRowData(dt, indexes);\n                });\n\n                $(document).on('click', '.action-button', function () {\n                    var action = $(this).data(\"action\");\n                    var primarybutton = \"btn-success\";\n                    if (action == \"waitlist\") {\n                        primarybutton = \"btn-info\";\n                    } else if (action == \"reject\") {\n                        primarybutton = \"btn-warning\";\n                    } else if (action == \"delete\") {\n                        primarybutton = \"btn-danger\";\n                    }\n                    if ($(this).hasClass(\"menu-action\")) {\n                        selecteddata = [$(this).data(\"id\")];\n                    }\n\n                    // If action is approve, we have to get groups first to show in the modal; otherwise, show modal.\n                    if (action == \"approve\") {\n                        // Get list of groups as a promise\n                        var getGroups = $.ajax({\n                            method: \"POST\",\n                            url: M.cfg.wwwroot + \"/enrol/gapply/ajax.php\",\n                            data: {\n                                action: \"getgroups\",\n                                id: $(\"#gapplytable\").data(\"instance\"),\n                                sesskey: M.cfg.sesskey,\n                            },\n                            dataType: \"json\",\n                        });\n                    } else {\n                        var getGroups = new Promise((resolve, reject) => {\n                            resolve([]);\n                        });\n                    }\n\n                    getGroups.then((data) => {\n                        var groupoptions = \"\";\n                        if (data.length > 0) {\n                            data.forEach(function (group) {\n                                // Render checkbox\n                                groupoptions += `<div class=\"custom-control custom-checkbox\">\n                                                        <input type=\"checkbox\" class=\"custom-control-input groups\" id=\"group-${group.id}\" name=\"groups[]\" value=\"${group.id}\">\n                                                        <label class=\"custom-control-label\" for=\"group-${group.id}\">${group.name}</label>\n                                                        </div>`;\n                            });\n\n                            groupoptions = `<div class=\"form-group mt-3\">\n                                                    <label for=\"groups\">${M.util.get_string('assigngroups', 'enrol_gapply')}</label>\n                                                    <div id=\"groups\">${groupoptions}</div>\n                                                </div>`;\n                        }\n\n                        var modal = `<div class=\"modal fade\" id=\"approveModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"approveModalLabel\"  aria-hidden=\"true\" style=\"background: rgba(0,0,0,0.5);\">\n                                    <div class=\"modal-dialog modal-dialog-centered\" role=\"document\">\n                                        <div class=\"modal-content\">\n                                            <div class=\"modal-header\">\n                                                <h5 class=\"modal-title\" id=\"approveModalLabel\">${M.util.get_string(action + 'applications', 'enrol_gapply')}</h5>\n                                                <button class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\n                                                <i class=\"fa fa-fw fa-times\"></i>\n                                                </button>\n                                                </div>\n                                            <div class=\"modal-body\">\n                                                <p class=\"mb-0\">${M.util.get_string('areyousureyouwantto' + action, 'enrol_gapply')}</p>\n                                                ${groupoptions}\n                                            </div>\n                                            <div class=\"modal-footer\">\n                                                <button   class=\"btn btn-secondary text-uppercase font-weight-bold\" data-dismiss=\"modal\">${M.util.get_string('cancel', 'enrol_gapply')}</button>\n                                                <button   class=\"btn ${primarybutton} text-uppercase font-weight-bold\" id=\"proceed\">${M.util.get_string('proceed', 'enrol_gapply')}</button>\n\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>`;\n                        // Remove any existing modal\n                        $(\"#approveModal\").remove();\n                        $(\"body\").append(modal);\n                        $(\"#approveModal\").modal(\"show\");\n\n                        // Approve\n                        $(\"#approveModal #proceed\").click(function () {\n                            $(\"#approveModal\").modal(\"hide\");\n                            $(\"#enrol-gapply-loading\").toggleClass(\"d-none d-flex\");\n                            $.ajax({\n                                url: \"/enrol/gapply/ajax.php\",\n                                method: \"POST\",\n                                data: {\n                                    action: action,\n                                    ids: selecteddata.toString(),\n                                    id: $(\"#gapplytable\").data(\"instance\"),\n                                    groups: $(\"#approveModal input.groups:checked\").map(function () {\n                                        return this.value;\n                                    }).get().toString(),\n                                    sesskey: M.cfg.sesskey,\n                                },\n                                success: function (data) {\n                                    // Reload page\n                                    location.reload();\n                                },\n                                error: function (data) {\n                                    location.reload();\n                                }\n                            });\n                        });\n                    });\n                });\n\n                $(document).on('click', '.showuserdetail', function () {\n                    $(\"#enrol-gapply-loading\").toggleClass(\"d-none d-flex\");\n                    var userid = $(this).data(\"userid\");\n\n                    var applicationid = $(this).data(\"id\");\n                    var status = $(this).data(\"statusformatted\");\n                    var sts = $(this).data(\"status\");\n                    selecteddata = [applicationid];\n                    var applicationtext = $(\".applicationtext[data-id='\" + applicationid + \"']\").html();\n                    var attachments = [];\n                    $('#gapplytable a.attachmentlink[data-id=\"' + applicationid + '\"]').each(function () {\n                        var file = {\n                            'link': $(this).data('url'),\n                            'filename': $(this).text(),\n                            'type': $(this).data('type'),\n                        };\n                        attachments.push(file);\n                    });\n                    var select = \"\";\n                    if (attachments.length > 0) {\n                        // Select input\n                        select = `<select class=\"custom-select w-100 my-2\" id=\"fileselect\">`;\n                        attachments.forEach(function (attachment) {\n                            select += `<option data-type=\"${attachment.type}\" value=\"${attachment.link}\">${attachment.filename}</option>`;\n                        });\n                        select += `</select>`;\n                    }\n\n                    // AJAX request to get user details\n                    $.ajax({\n                        url: M.cfg.wwwroot + `/enrol/gapply/ajax.php?action=getuserbyid&id=${id}&userid=` + userid + '&sesskey=' + M.cfg.sesskey,\n                        type: 'GET'\n                    }).fail(response => {\n                        var modal = `<div class=\"modal fade\" id=\"userdetailModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"userdetailModalLabel\" aria-hidden=\"true\">\n                                        <div class=\"modal-dialog modal-xl\" role=\"document\" style=\"max-width: calc(100% - 2rem);\">\n                                            <div class=\"modal-content\">\n                                            ${response.responseText}\n                                            </div>\n                                        </div>\n                                    </div>`;\n                        // Remove any existing modal\n                        $(\"#userdetailModal\").remove();\n                        $(\"body\").append(modal);\n                        $(\"#userdetailModal\").modal(\"show\");\n                        if (sts == \"approved\") {\n                            $(\"#userdetailModal .action-button\").remove();\n                        }\n\n                        $(\"#enrol-gapply-loading\").toggleClass(\"d-none d-flex\");\n                        $(\"#userdetailModal .select-input\").html(select);\n                        $(\"#userdetailModal #applicationtext\").html(applicationtext);\n                        $(\"#userdetailModal #currentstatus\").html(status);\n                        let changefile = function (url, type, name) {\n                            $(\".fileview #viewer\").html(name);\n                            if (type.includes(\"image\")) {\n                                $(\".fileview #viewer\").html(`<img src=\"${url}\" class=\"img-fluid mx-auto\">`);\n                            } else if (type.includes(\"video\")) {\n                                $(\".fileview #viewer\").html(`<video src=\"${url}\"\n                    class=\"embed-responsive-item text-center m-0\" controls width=\"100%\" autoplay></video>`);\n                            } else if (type.includes(\"audio\")) {\n                                $(\".fileview #viewer\").html(`<audio src=\"${url}\"\n                    class=\"embed-responsive-item text-center m-0\" controls width=\"100%\" autoplay></audio>`);\n                            } else if (type.includes(\"pdf\")) {\n                                $(\".fileview #viewer\").html(`<object data=\"${url}\" type=\"application/pdf\"\n                     width=\"100%\" style=\"height: calc(100% - 7px);\">\n                                            <p>${M.util.get_string('cannotopenpdffile', 'enrol_gapply', url)}</p>\n                                            </object>`);\n                            } else if (type.includes(\"officedocument\") || type.includes(\"msword\")\n                                || type.includes(\"ms-excel\") || type.includes(\"ms-powerpoint\") || type.includes(\"openxmlformats\")) {\n                                $(\".fileview #viewer\").html(`<iframe id=\"fileviewer\"\n                    src=\"https://view.officeapps.live.com/op/embed.aspx?src=${url}\"\n                    class=\"embed-responsive-item\" style=\"width: 100%; height: calc(100% - 7px);\"></iframe>`);\n                            } else if (type.includes(\"text\") || type.includes(\"csv\")) {\n                                $(\".fileview #viewer\").html(`<iframe id=\"fileviewer\"\n                    src=\"https://docs.google.com/viewer?url=${url}&embedded=true\"\n                    class=\"embed-responsive-item\" style=\"width: 100%; height:  calc(100% - 7px); border-radius: 0\"></iframe>`);\n                            } else {\n                                $(\".fileview #viewer\").html(`<p\n                    class=\"text-center py-5\">${M.util.get_string('cannotopenfile', 'enrol_gapply', url)}</p>`);\n                            }\n                            $(\"#userdetailmodalLabel\").html(name);\n                            $(\"#downloadbutton\").attr(\"href\", url);\n                        };\n\n                        $(\"#fileselect\").change(function () {\n                            changefile($(this).val(), $(this).find(\":selected\").data(\"type\"), $(this).find(\":selected\").text());\n                        });\n\n                        $(\"#fileselect\").trigger(\"change\");\n                    }).done(response => {\n                        $(\"#enrol-gapply-loading\").toggleClass(\"d-none d-flex\");\n                        window.console.log(response);\n                    });\n\n                });\n\n                $(document).on('click', '#selectall', function () {\n                    if ($(this).is(\":checked\")) {\n                        table.rows({\n                            search: 'applied'\n                        }).select();\n                    } else {\n                        table.rows().deselect();\n                    }\n                });\n\n            }\n\n        };\n    });"],"names":["define","$","JSZip","toast","window","init","tab","id","on","e","modal","M","util","get_string","remove","append","html","this","text","data","includes","removeClass","newURL","URL","searchParams","open","toString","timecreatedIndex","index","profileFields","each","element","pr","push","option","ajax","url","cfg","wwwroot","sesskey","dataSrc","json","deferRender","rowId","dom","buttons","extend","titleAttr","className","messageTop","title","exportOptions","columns","select","rows","_","orderable","targets","visible","hasClass","wrap","addClass","css","insertAfter","forEach","appendTo","style","selector","selecteddata","table","DataTable","value","val","column","search","draw","colIndex","order","getRowData","selected","toArray","map","row","length","after","dt","type","indexes","document","action","primarybutton","getGroups","method","dataType","Promise","resolve","reject","then","groupoptions","group","name","click","toggleClass","ids","groups","get","success","location","reload","error","userid","applicationid","status","sts","applicationtext","attachments","file","attachment","link","filename","fail","response","responseText","change","find","attr","trigger","done","console","log","is","deselect"],"mappings":"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"}